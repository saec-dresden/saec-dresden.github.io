"use strict";var common=require("./common");var YAMLException=require("./exception");var Type=require("./type");function compileList(d,b,c){var a=[];d.include.forEach(function(e){c=compileList(e,b,c)});d[b].forEach(function(e){c.forEach(function(g,f){if(g.tag===e.tag){a.push(f)}});c.push(e)});return c.filter(function(f,e){return -1===a.indexOf(e)})}function compileMap(){var d={},b,c;function a(e){d[e.tag]=e}for(b=0,c=arguments.length;b<c;b+=1){arguments[b].forEach(a)}return d}function Schema(a){this.include=a.include||[];this.implicit=a.implicit||[];this.explicit=a.explicit||[];this.implicit.forEach(function(b){if(null!==b.loader&&"string"!==b.loader.kind){throw new YAMLException("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}});this.compiledImplicit=compileList(this,"implicit",[]);this.compiledExplicit=compileList(this,"explicit",[]);this.compiledTypeMap=compileMap(this.compiledImplicit,this.compiledExplicit)}Schema.DEFAULT=null;Schema.create=function createSchema(){var a,b;switch(arguments.length){case 1:a=Schema.DEFAULT;b=arguments[0];break;case 2:a=arguments[0];b=arguments[1];break;default:throw new YAMLException("Wrong number of arguments for Schema.create function")}a=common.toArray(a);b=common.toArray(b);if(!a.every(function(c){return c instanceof Schema})){throw new YAMLException("Specified list of super schemas (or a single Schema object) contains a non-Schema object.")}if(!b.every(function(c){return c instanceof Type})){throw new YAMLException("Specified list of YAML types (or a single Type object) contains a non-Type object.")}return new Schema({include:a,explicit:b})};module.exports=Schema;