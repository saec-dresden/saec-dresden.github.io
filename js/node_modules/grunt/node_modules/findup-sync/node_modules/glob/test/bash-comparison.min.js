var tap=require("tap"),child_process=require("child_process"),bashResults=require("./bash-results.json"),globs=Object.keys(bashResults),glob=require("../"),path=require("path");process.chdir(path.resolve(__dirname,".."));function alphasort(c,d){c=c.toLowerCase();d=d.toLowerCase();return c>d?1:c<d?-1:0}globs.forEach(function(b){var a=bashResults[b];if(process.platform==="win32"&&a.some(function(c){return/\/symlink\//.test(c)})){return}tap.test(b,function(c){glob(b,function(d,e){if(d){throw d}e=cleanResults(e);c.deepEqual(e,a,b);c.end()})});tap.test(b+" sync",function(d){var c=cleanResults(glob.sync(b));d.deepEqual(c,a,"should match shell");d.end()})});function cleanResults(a){return a.map(function(b){return b.replace(/\/+/g,"/").replace(/\/$/,"")}).sort(alphasort).reduce(function(c,b){if(b!==c[c.length-1]){c.push(b)}return c},[]).sort(alphasort).map(function(b){return(process.platform!=="win32")?b:b.replace(/^[a-zA-Z]:[\/\\]+/,"/").replace(/[\\\/]+/g,"/")})};