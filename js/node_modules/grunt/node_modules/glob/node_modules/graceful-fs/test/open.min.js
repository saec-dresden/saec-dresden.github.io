var test=require("tap").test;var fs=require("../graceful-fs.js");test("graceful fs is not fs",function(a){a.notEqual(fs,require("fs"));a.end()});test("open an existing file works",function(c){var b=fs._curOpen;var a=fs.openSync(__filename,"r");c.equal(fs._curOpen,b+1);fs.closeSync(a);c.equal(fs._curOpen,b);fs.open(__filename,"r",function(d,e){if(d){throw d}c.equal(fs._curOpen,b+1);fs.close(e,function(f){if(f){throw f}c.equal(fs._curOpen,b);c.end()})})});test("open a non-existing file throws",function(d){var c=fs._curOpen;var a;try{var b=fs.openSync("this file does not exist","r")}catch(e){a=e}d.ok(a,"should throw");d.notOk(b,"should not get an fd");d.equal(a.code,"ENOENT");d.equal(fs._curOpen,c);fs.open("neither does this file","r",function(f,g){d.ok(f,"should throw");d.notOk(g,"should not get an fd");d.equal(f.code,"ENOENT");d.equal(fs._curOpen,c);d.end()})});