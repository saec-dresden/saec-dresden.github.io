var fs=require("graceful-fs");var test=require("tap").test;var glob=require("../");test("mock fs",function(g){var e=fs.stat;var f=fs.statSync;var c=fs.readdir;var d=fs.readdirSync;function b(h){var i;switch(h.toLowerCase()){case"/tmp":case"/tmp/":i={isDirectory:function(){return true}};break;case"/tmp/a":i={isDirectory:function(){return false}};break}return i}fs.stat=function(j,h){var i=b(j);if(i){process.nextTick(function(){h(null,i)})}else{e.call(fs,j,h)}};fs.statSync=function(h){return b(h)||f.call(fs,h)};function a(h){var i;switch(h.toLowerCase()){case"/tmp":case"/tmp/":i=["a","A"];break;case"/":i=["tmp","tMp","tMP","TMP"]}return i}fs.readdir=function(j,h){var i=a(j);if(i){process.nextTick(function(){h(null,i)})}else{c.call(fs,j,h)}};fs.readdirSync=function(h){return a(h)||d.call(fs,h)};g.pass("mocked");g.end()});test("nocase, nomagic",function(b){var a=2;var c=["/TMP/A","/TMP/a","/tMP/A","/tMP/a","/tMp/A","/tMp/a","/tmp/A","/tmp/a"];glob("/tmp/a",{nocase:true},function(d,e){if(d){throw d}b.same(e.sort(),c);if(--a===0){b.end()}});glob("/tmp/A",{nocase:true},function(d,e){if(d){throw d}b.same(e.sort(),c);if(--a===0){b.end()}})});test("nocase, with some magic",function(a){a.plan(2);var b=["/TMP/A","/TMP/a","/tMP/A","/tMP/a","/tMp/A","/tMp/a","/tmp/A","/tmp/a"];glob("/tmp/*",{nocase:true},function(c,d){if(c){throw c}a.same(d.sort(),b)});glob("/tmp/*",{nocase:true},function(c,d){if(c){throw c}a.same(d.sort(),b)})});